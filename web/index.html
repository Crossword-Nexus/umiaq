
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="umiaq.css">
  <title>Umiaq Solver</title>
  <style>
    body { font-family: sans-serif; margin: 2em; }
    input {font-size: 1.25em;}
    pre {font-size: 1.25em;}
    #results { margin-top: 1em; white-space: pre-wrap; }
    #loading { font-style: italic; color: gray; }
    #spinner { display: inline-block; width: 1em; height: 1em; border: 2px solid #ccc; border-top: 2px solid #333; border-radius: 50%; animation: spin 1s linear infinite; margin-right: 0.5em; }
    @keyframes spin { 100% { transform: rotate(360deg); } }
    #mainUI { display: none; }
    #wordlistStatus { margin-top: 0.5em; font-style: italic; color: green; }
    details.examples { margin-top: 2em;}
  </style>
  <!-- Word list processing -->
  <script src="wordlist.js" type="text/javascript"></script>
  <!-- skeleton.css -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/skeleton/2.0.4/skeleton.min.css" />
</head>
<body>
  <!-- modal box placeholder -->
  <div class="cw-modal" id="cw-modal"></div>
  <h1>Umiaq</h1>
  <div id="loading"><span id="spinner"></span>Loading ...</div>

  <div id="mainUI">
    <form>
      <label class="label">
        <span class="label-text">Pattern:</span>
        <input class="input" id="input" size=40></input>
      </label>
      <button class="button-primary">Search</button>
    </form>

    <button type="submit" id="wordlist-button" value="Upload wordlist">(Optional) Upload wordlist</button>

    <div id="results"></div>

    <div id="examples-container"></div>

  </div>

  <p>
    <a href="https://www.youtube.com/watch?v=cZzTHqe1n-w" target="_blank">How-To Video</a>
     •
     <a href="https://github.com/crosswordnexus/umiaq" target="_blank">Source Code</a>
  </p>

  <script type="module">
    import init, { solve_equation_wasm } from "../pkg/umiaq_rust.js";

    (async () => {
      await init();

      // load and process the default wordlist
      await getLocalWordList();

      window.solve_equation_wasm = solve_equation_wasm;

      // Hide and show
      document.getElementById("loading").style.display = "none";
      document.getElementById("mainUI").style.display = "block";
    })();

  </script>

  <script>
    // Define what happens when the "solve" button is clicked
    async function solve(event) {
      event.preventDefault();
      document.getElementById("results").textContent = 'Loading ...';

      const input = document.getElementById("input").value.trim();

      const jsResult = window.solve_equation_wasm(input, window.wordlist, 100);
      console.log(jsResult);
      let output = '';
      jsResult.forEach(x => {
        output += x.join(" • ");
        output += "\n";
      });
      if (!output) output = 'No matches found.';
      document.getElementById("results").textContent = output;
    }
    document.querySelector("form").addEventListener("submit", solve);
  </script>

  <script>
    // Load the examples
    fetch("examples.html")
      .then(response => response.text())
      .then(html => {
        document.getElementById("examples-container").innerHTML = html;
      });
    // attach listener
    document.getElementById('wordlist-button').addEventListener('click', createWordlistModal);
  </script>

</body>
</html>
